<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="dns-prefetch" href="https://blog.xxwhite.com">
  <title>Unity WebGL平台开发遇到的坑 | 叉叉白</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="最近在用Unity做一个 WebGL 平台的项目，开发过程中遇到了各种各样的坑，这里简单记录一下，以免以后再踩。">
<meta name="keywords" content="Unity, WebGL, JS数据交互, C#">
<meta property="og:type" content="article">
<meta property="og:title" content="Unity WebGL平台开发遇到的坑">
<meta property="og:url" content="https://blog.xxwhite.com/2019/unity-webgl-keng.html">
<meta property="og:site_name" content="叉叉白">
<meta property="og:description" content="最近在用Unity做一个 WebGL 平台的项目，开发过程中遇到了各种各样的坑，这里简单记录一下，以免以后再踩。">
<meta property="og:locale" content="Zh-cn">
<meta property="og:image" content="https://s2.ax1x.com/2019/04/29/E1c9i9.png">
<meta property="og:updated_time" content="2019-05-01T06:01:15.379Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unity WebGL平台开发遇到的坑">
<meta name="twitter:description" content="最近在用Unity做一个 WebGL 平台的项目，开发过程中遇到了各种各样的坑，这里简单记录一下，以免以后再踩。">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/04/29/E1c9i9.png">
  
    <link rel="alternative" href="/atom.xml" title="叉叉白" type="application/atom+xml">
  
  
    <link rel="icon" href="https://oss.xxwhite.com/static/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/assets/./main.d64582.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  <script>function loadScript(e,t){d=document,o=d.createElement("script"),s=d.getElementsByTagName("head")[0].appendChild(o),o.setAttribute("src",e),t&&o.addEventListener("load",function(e){t(e)}),s.parentNode.insertBefore(o,s)}</script>
  <script defer="defer" src="/assets/./main.d64582.js"></script>
</head>
</html>
<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="" class="profilepic">
			<img src="https://oss.xxwhite.com/static/avatar.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="">MonoLogueChi</a></h1>
		</hgroup>
		
		<p class="header-subtitle">叉叉白，听我跟你瞎白话</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/搞机/">搞机</a></li>
	        
				<li><a href="/tags/建站笔记/">笔记</a></li>
	        
				<li><a href="/MessageBoard/">留言</a></li>
	        
				<li><a href="/aboutme/">关于</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于本站</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/MonoLogueChi" title="github"><i class="icon-github"></i></a>
		        
					<a class="weixin" target="_blank" href="https://s1.ax2x.com/2018/07/14/q4v9K.png" title="weixin"><i class="icon-weixin"></i></a>
		        
					<a class="bilibili" target="_blank" href="https://space.bilibili.com/28474682/" title="bilibili"><i class="icon-bilibili"></i></a>
		        
					<a class="mail" target="_blank" href="mailto:xxwhite@foxmail.com" title="mail"><i class="icon-mail"></i></a>
		        
					<a class="rss" target="_blank" href="/atom.xml" title="rss"><i class="icon-rss"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<a href="/"><img src="https://oss.xxwhite.com/static/avatar.jpg" class="js-avatar"></a>
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">MonoLogueChi</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>叉叉白，听我跟你瞎白话<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/MonoLogueChi" title="github"><i class="icon-github"></i></a>
			        
						<a class="weixin" target="_blank" href="https://s1.ax2x.com/2018/07/14/q4v9K.png" title="weixin"><i class="icon-weixin"></i></a>
			        
						<a class="bilibili" target="_blank" href="https://space.bilibili.com/28474682/" title="bilibili"><i class="icon-bilibili"></i></a>
			        
						<a class="mail" target="_blank" href="mailto:xxwhite@foxmail.com" title="mail"><i class="icon-mail"></i></a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss"><i class="icon-rss"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 20%"><a href="/">主页</a></li>
		        
					<li style="width: 20%"><a href="/tags/搞机/">搞机</a></li>
		        
					<li style="width: 20%"><a href="/tags/建站笔记/">笔记</a></li>
		        
					<li style="width: 20%"><a href="/MessageBoard/">留言</a></li>
		        
					<li style="width: 20%"><a href="/aboutme/">关于</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-2019/unity-webgl-keng" class="article article-type-post " itemscope="" itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Unity WebGL平台开发遇到的坑
    </h1>
  

        
        <a href="/2019/unity-webgl-keng.html" class="archive-article-date">
  	<time datetime="2019-04-29T12:48:35.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2019-04-29</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近在用Unity做一个 WebGL 平台的项目，开发过程中遇到了各种各样的坑，这里简单记录一下，以免以后再踩。</p>
<a id="more"></a>
<h2 id="webrequest请求异步的问题"><a class="markdownIt-Anchor" href="#webrequest请求异步的问题"></a> WebRequest请求（异步的问题）</h2>
<p>首先是Http请求的问题，我最开始想的是，直接用C#里的写法，编辑器里测试毫无问题，但是一打包出来就不行，会报出 <code>SystemException: Thread creation failed.</code> 的错误，无奈只能用Unity自己的 <code>UnityWebRequest</code>。</p>
<p>错误的示范0：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">WrongGet</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> (HttpClient httpClient = <span class="keyword">new</span> HttpClient())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> text = httpClient.GetStringAsync(<span class="string">"https://www.baidu.com/艹"</span>).Result;</span><br><span class="line">        Debug.Log(text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>错误的示范1：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">WrongGet</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> (WebClient webClient = <span class="keyword">new</span> WebClient())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> text = webClient.DownloadString(<span class="string">"https://www.baidu.com/艹"</span>);</span><br><span class="line">        Debug.Log(text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样写后果会比上面这种更严重，整个程序直接崩溃</p>
<p><img src="https://s2.ax1x.com/2019/04/29/E1c9i9.png" alt="后果"></p>
<p>正确的示范：</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> IEnumerator <span class="title">Get</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> webRequest = UnityWebRequest.Get(<span class="string">"https://www.baidu.com/艹"</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">return</span> webRequest.SendWebRequest();</span><br><span class="line">        <span class="keyword">if</span> (!webRequest.isNetworkError &amp;&amp; !webRequest.isHttpError)</span><br><span class="line">            Debug.Log(webRequest.downloadHandler.text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>感觉这是异步的问题，因为js是单线程的。</p>
<p><strong>如果确定要打包WebGL平台，就不要用异步，用协程比较稳，另外，尽量用Unity自己的那一套东西</strong></p>
<h2 id="ssl证书"><a class="markdownIt-Anchor" href="#ssl证书"></a> SSL证书</h2>
<p>这个不知道是什么鬼问题，Unity编辑器不支持ECC证书？还是其他什么问题，测试是在我的服务器上测试的，我的服务器配的是ECC证书，最开始在我的电脑上是不支持的，一直报错，后来不知道发生了什么，竟然莫名奇妙的支持了，这件事也就网了，但是后面代码合并的时候，到我同事的电脑上，又出现了这个问题，没办法，只能暂时先用http顶着了，后面再说申请RSA证书的事。</p>
<p>到后面打包出来测试的时候，又出问题了，里面的资源已经数据请求，都是用的http协议，但是我最后访问页面的时候，用的是https协议，https页面里，会阻断不安全的http请求，没办法，RSA证书的事提上日程，先搞定。</p>
<p><strong>Unity Editor中发起https请求，如果后端是RSA证书没问题，后端是ECC证书可能会出问题</strong></p>
<h2 id="json"><a class="markdownIt-Anchor" href="#json"></a> JSON</h2>
<p>接下来是JSON序列化和反序列化，一提到JSON，最先想到的是 <code>JSON.NET库</code>，也就是<code>Newtonsoft.Json</code>库。用这个没毛病，从nuget上下载下来，然后把dll文件拖进去，OK。在编辑器里一切都没问题，但是一打包成网页就出问题。</p>
<p>什么问题呢？写一段正常的代码</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">string</span> json = <span class="string">"json字符串"</span>;</span><br><span class="line">Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; dic = JsonConvert.DeserializeObject&lt;Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt;&gt;(json);</span><br></pre></td></tr></table></figure>
<p>这样没毛病，一切OK，但是要按照下面这样写，就会踩雷</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Dic</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> code &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Dictionary&lt;<span class="keyword">string</span>, <span class="keyword">string</span>&gt; data &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Dic <span class="title">DeDic</span>(<span class="params"><span class="keyword">string</span> json</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> JsonConvert.DeserializeObject&lt;Dic&gt;(json);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果是按照上面这样写，恭喜你，打包出来的东西肯定报错，反序列化得到的全都是null。</p>
<p>而且网上搜索的话，很难搜到原因，貌似遇到这个问题的人并不多？没办法，求着后端小哥哥帮忙改接口，把接口全都写成 key-value 的形式就可以用了。</p>
<p>为什么会出现这个问题？在原本都已经放弃的时候，无意中发现了这个插件 <a href="https://assetstore.unity.com/packages/tools/input-management/json-net-for-unity-11347" target="_blank" rel="noopener">JSON.NET FOR UNITY</a>，在这个插件的介绍里找到了答案</p>
<blockquote>
<p>While many in the Unity Community have succeeded in getting JSON .NET to work for their games, it has never worked properly with iOS or IL2CPP. The iOS errors are due to incompatibilities with AOT (Ahead of Time Compilation) that is used by Mono/IL2CPP in iOS.</p>
</blockquote>
<p>大致的意思就是，JSON.NET在iSO平台上因为ATO的问题不能直接用，我想WebGL应该也是类似的问题吧，看着这个插件的支持平台上，写了WebGL，抱着试一试的想法尝试了一下，还真的可以，行得通，这个坑算是解决了，反序列化Json不能直接用JSON.NET库，要用Unity商店里的那个插件。</p>
<p><strong>在Unity里，非桌面平台，尽量少用nuget仓库里的东西，如果要用，也要先确保Unity不同平台的支持情况，尽量用Unity商店里的插件，因为Unity商店里的插件一般都会注明平台支持情况</strong></p>
<h2 id="跨域"><a class="markdownIt-Anchor" href="#跨域"></a> 跨域</h2>
<p>相比其他问题，这个问题已经不能叫问题了，只要稍微有点Web开发经要就能解决，因为所有请求都是从js里发出的，所以很容易遇到跨域问题，只要加上对应的返回头就可以了 <code>Access-Control-Allow-Origin</code>。</p>
<p><strong>Unity打包WebGL平台文件时，要尤其注意跨域问题，一定要提前和后端讲明</strong></p>
<h2 id="ab包"><a class="markdownIt-Anchor" href="#ab包"></a> AB包</h2>
<p>相比之下，AB包就没什么坑了，中规中矩，常规用法就可以了，建议按场景打包，虽然会有重复资源，但是操作简单啊，如果自己手动分包的话，麻烦的要死。</p>
<p>唯一要注意的一点就是IL2CPP编译时代码剥离的问题，这一点随便一百度，都会有很多教程告诉你怎么做。</p>
<h2 id="音频"><a class="markdownIt-Anchor" href="#音频"></a> 音频</h2>
<p>我们使用了网络音频，所以要注意网络音频的格式，打包出来的网页网络音频要用wav格式的，而在客户端可以使用ogg格式。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> IEnumerator <span class="title">PlayWebAudio</span>(<span class="params"><span class="keyword">string</span> url, <span class="keyword">float</span> d</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> UNITY_EDITOR || !UNITY_WEBGL</span></span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> www = UnityWebRequestMultimedia.GetAudioClip(url, AudioType.OGGVORBIS))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">elif</span> UNITY_WEBGL</span></span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> www = UnityWebRequestMultimedia.GetAudioClip(url, AudioType.WAV))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">return</span> www.SendWebRequest();</span><br><span class="line">        <span class="function"><span class="keyword">yield</span> return new <span class="title">WaitForSeconds</span>(<span class="params">d</span>)</span>;</span><br><span class="line">        <span class="keyword">if</span> (www.isNetworkError || www.isHttpError)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.Log(www.error);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> clip = DownloadHandlerAudioClip.GetContent(www);</span><br><span class="line">            PlayAudioClip(clip);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Unity在使用网络资源的时候，要注意音频格式，不同平台的支持情况不一样，不确定的时候就用wav格式吧</strong></p>
<h2 id="程序内与网页传参"><a class="markdownIt-Anchor" href="#程序内与网页传参"></a> 程序内与网页传参</h2>
<p>这个看了半天也没搞懂真正的用法，只能写个简单点的函数</p>
<p>先说明一下，能百度到的东西，很多都是过时的，而且大家都是你抄我，他抄你，抄来抄去，没啥意思。我找了一圈，就发现一篇是比较实用的，而且写得也挺易懂的 <a href="https://blog.csdn.net/beihuanlihe130/article/details/76214551" target="_blank" rel="noopener">链接</a></p>
<p>最好的工具是Unity的官方文档，这个文档写的真不错，很多方法都有很详细的示例 <a href="https://docs.unity3d.com/Manual/webgl-interactingwithbrowserscripting.html" target="_blank" rel="noopener">文档</a></p>
<p>因为以前在UE4上也研究过这个东西，所以对 Emscripten 也有一定的了解。看一下文档就大致该知道怎么做了。</p>
<p>首先是在 <code>Plugins目录下</code> 创建一个 <code>.jslib</code> 文件，名字叫什么都无所谓，然后在里面写一些函数，尽量简单一点，越简单越好，函数的形式可以参考官方文档，要注意，官方文档给的这几个示例函数都是比较具有代表性的，基本上你能用到的东西，都已经告诉你该怎么处理了，传参，返回值，资源处理，该有的都有了。</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mergeInto(<span class="name">LibraryManager</span>.library, &#123;</span><br><span class="line">  Hello: function () &#123;</span><br><span class="line">    window.alert(<span class="string">"Hello, world!"</span>)<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  HelloString: function (<span class="name">str</span>) &#123;</span><br><span class="line">    window.alert(<span class="name">Pointer_stringify</span>(<span class="name">str</span>))<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  PrintFloatArray: function (<span class="name">array</span>, size) &#123;</span><br><span class="line">    for(<span class="name">var</span> i = <span class="number">0</span><span class="comment">; i &lt; size; i++)</span></span><br><span class="line">    console.log(<span class="name">HEAPF32</span>[(<span class="name">array</span> &gt;&gt; <span class="number">2</span>) + i])<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  AddNumbers: function (<span class="name">x</span>, y) &#123;</span><br><span class="line">    return x + y<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  StringReturnValueFunction: function () &#123;</span><br><span class="line">    var returnStr = <span class="string">"bla"</span><span class="comment">;</span></span><br><span class="line">    var bufferSize = lengthBytesUTF8(<span class="name">returnStr</span>) + <span class="number">1</span><span class="comment">;</span></span><br><span class="line">    var buffer = _malloc(<span class="name">bufferSize</span>)<span class="comment">;</span></span><br><span class="line">    stringToUTF8(<span class="name">returnStr</span>, buffer, bufferSize)<span class="comment">;</span></span><br><span class="line">    return buffer<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  BindWebGLTexture: function (<span class="name">texture</span>) &#123;</span><br><span class="line">    GLctx.bindTexture(<span class="name">GLctx</span>.TEXTURE_2D, GL.textures[texture])<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>在需要调用的时候，这样写</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NewBehaviourScript</span> : <span class="title">MonoBehaviour</span> &#123;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">Hello</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">HelloString</span>(<span class="params"><span class="keyword">string</span> str</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">PrintFloatArray</span>(<span class="params"><span class="keyword">float</span>[] array, <span class="keyword">int</span> size</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">AddNumbers</span>(<span class="params"><span class="keyword">int</span> x, <span class="keyword">int</span> y</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">string</span> <span class="title">StringReturnValueFunction</span>(<span class="params"></span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">BindWebGLTexture</span>(<span class="params"><span class="keyword">int</span> texture</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        Hello();</span><br><span class="line">        </span><br><span class="line">        HelloString(<span class="string">"This is a string."</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">float</span>[] myArray = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">10</span>];</span><br><span class="line">        PrintFloatArray(myArray, myArray.Length);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> result = AddNumbers(<span class="number">5</span>, <span class="number">7</span>);</span><br><span class="line">        Debug.Log(result);</span><br><span class="line">        </span><br><span class="line">        Debug.Log(StringReturnValueFunction());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> texture = <span class="keyword">new</span> Texture2D(<span class="number">0</span>, <span class="number">0</span>, TextureFormat.ARGB32, <span class="literal">false</span>);</span><br><span class="line">        BindWebGLTexture(texture.GetNativeTextureID());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个示例，能看懂的人肯定是一看就懂，看不懂的估计还要再补一下基础知识，仿照这个示例，咱们自己来写一个</p>
<p>jslib：</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mergeInto(<span class="name">LibraryManager</span>.library, &#123;</span><br><span class="line">  GetUrlParam: function (<span class="name">str</span>) &#123;</span><br><span class="line">    var paraName = Pointer_stringify(<span class="name">str</span>)<span class="comment">;</span></span><br><span class="line">    var result = GetUrlParamFun(<span class="name">paraName</span>)<span class="comment">;</span></span><br><span class="line">    var bufferSize = lengthBytesUTF8(<span class="name">result</span>) + <span class="number">1</span><span class="comment">;</span></span><br><span class="line">    var buffer = _malloc(<span class="name">bufferSize</span>)<span class="comment">;</span></span><br><span class="line">    stringToUTF8(<span class="name">result</span>, buffer, bufferSize)<span class="comment">;</span></span><br><span class="line">    return buffer<span class="comment">;</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>简单分析一下，有个方法叫<code>GetUrlParam</code>，带有一个参数，已经确定需要传字符串进来，所以需要使用<code>Pointer_stringify()</code>方法，注意传参是将内容写入内存，使用指针去指的所以要用<code>Pointer_stringify</code>，再下面，调用一个叫<code>GetUrlParamFun</code>的函数，获取返回值，再后面就是将结果返回给Unity，也是将结果写入内存，然后用指针去指。（我指针理解的不够透彻，上面这段话难免会有一些问题）</p>
<p>需要在网页中插入一段js：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetUrlParamFun</span>(<span class="params">paraName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> url = <span class="built_in">document</span>.location.toString();</span><br><span class="line">    <span class="keyword">var</span> arrObj = url.split(<span class="string">"?"</span>);</span><br><span class="line">        <span class="keyword">if</span> (arrObj.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> arrPara = arrObj[<span class="number">1</span>].split(<span class="string">"&amp;"</span>);</span><br><span class="line">            <span class="keyword">var</span> arr;</span><br><span class="line">            arr = arrPara[i].split(<span class="string">"="</span>);</span><br><span class="line">            <span class="keyword">if</span> (arr != <span class="literal">null</span> &amp;&amp; arr[<span class="number">0</span>] == paraName) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(arr[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面这一段代码是用来获取页面url中的参数的</p>
<p>C#脚本中写</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> UnityEngine;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !UNITY_EDITOR &amp;&amp; UNITY_WEBGL</span></span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">XXXX</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !UNITY_EDITOR &amp;&amp; UNITY_WEBGL</span></span><br><span class="line">    [<span class="meta">DllImport(<span class="meta-string">"__Internal"</span>)</span>] <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">extern</span> <span class="keyword">string</span> <span class="title">GetUrlParam</span>(<span class="params"><span class="keyword">string</span> str</span>)</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !UNITY_EDITOR &amp;&amp; UNITY_WEBGL</span></span><br><span class="line">    	<span class="keyword">string</span> <span class="keyword">from</span> = GetUrlParam(<span class="string">"from"</span>);</span><br><span class="line">    	Debug.Log(<span class="keyword">from</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就会打印出来我们访问地址参数form，例如访问 <code>http://localhost?id=0&amp;from=kkkkkk</code>，会打印出来 <code>kkkkkk</code></p>
<p><strong>Unity调用JS代码，一点都不难，只要按照官方文档走就可以了，Unity的生态真的非常好，对新手友好，吐槽一下辣鸡UE4，文档乱的像坨翔</strong></p>

      

      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>请作者吃辣条<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="https://oss.xxwhite.com/static/alipay.png">
                      <span class="reward-type">支付宝</span>
                    </div>
                    
                    
                    <div class="reward-box-item">
                      <img class="reward-img" src="https://oss.xxwhite.com/static/wechatpay.png">
                      <span class="reward-type">微信</span>
                    </div>
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
            
      
        <div> 
          <ul class="post-copyright">
            <li>
              <strong>本文作者：</strong>
              MonoLogueChi
            </li>
            <li>
              <strong>本文链接：</strong>
              <a href="https://blog.xxwhite.com/2019/unity-webgl-keng.html" title="叉叉白">https://blog.xxwhite.com/2019/unity-webgl-keng.html</a>
            </li>
            <li>
              <strong>版权声明： </strong>
              本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！
            </li>
          </ul>
        </div>
      

    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">Unity</a>
        		</li>
      		
		</ul>
	</div>

      

      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
  
    <a href="/2019/ddns.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">在家搭建网站-DDNS</div>
      <i class="icon-circle-right"></i>
    </a>
  
  <br>
      
    <a onclick="mdpage()" target="_blank" style="cursor:pointer">获取文章MarkDown文件</a>
  
   
  <span style="float:right;color:#0094d5" id="/2019/unity-webgl-keng.html" class="leancloud_visitors" data-flag-title="Unity WebGL平台开发遇到的坑">
      <span class="post-meta-item-text">本文阅读量 </span>
      <span class="leancloud-visitors-count">8848</span>
    </span>
 
</nav>
<script>
  var mdhost = 'https://raw.githubusercontent.com/MonoLogueChi/blog.xxwhite.com/master/source/_posts';
  var mdurl = '2019/unity-webgl-keng.html'.replace('.html', '.md');
  function mdpage() {
    window.open(mdhost + "/" + mdurl);
  }
</script>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#webrequest请求异步的问题"><span class="toc-number">1.</span> <span class="toc-text"> WebRequest请求（异步的问题）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssl证书"><span class="toc-number">2.</span> <span class="toc-text"> SSL证书</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json"><span class="toc-number">3.</span> <span class="toc-text"> JSON</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#跨域"><span class="toc-number">4.</span> <span class="toc-text"> 跨域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ab包"><span class="toc-number">5.</span> <span class="toc-text"> AB包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#音频"><span class="toc-number">6.</span> <span class="toc-text"> 音频</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#程序内与网页传参"><span class="toc-number">7.</span> <span class="toc-text"> 程序内与网页传参</span></a></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  

  
  
  
    <section id="comments">
      <div id="vcomment"></div>
<script async>
    var notify = false == true ? true : false;
    var verify = false == true ? true : false;
    var visitor = true == true ? true : false;
    var recordIP = true == true ? true : false;
    loadScript('https://cdn.jsdelivr.net/npm/valine@1.3.6/dist/Valine.min.js',function(){
    loadScript('https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js',function(){
        AV.init({
            appId: 'BOnDPDiz9EeoGAC11JdnV9mw-gzGzoHsz',
            appKey: 'gNFFgOahNl9DGsyX1WearaYO',
            serverURLs: 'https://avoscloud.com'
        });
        new Valine({
            el: '#vcomment',
            notify: notify,
            verify: verify,
            appId: 'BOnDPDiz9EeoGAC11JdnV9mw-gzGzoHsz',
            appKey: 'gNFFgOahNl9DGsyX1WearaYO',
            placeholder: '友情提醒，留下正确的邮箱地址可以第一时间获取评论反馈',
            avatar: '',
            avatar_cdn: 'https://sdn.geekzu.org/avatar/',
            pageSize: 12,
            path: '/2019/unity-webgl-keng.html',
            visitor: visitor,
            recordIP: recordIP
        });
        if(window.location.hash){
          var checkExist = setInterval(function() {
            if (document.getElementById(window.location.hash.replace("#",""))) {
              location.href = window.location.hash;
              clearInterval(checkExist);
            }
          }, 250);
        }
    });
    });
</script>
    </section>
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017-2019 MonoLogueChi
    		
          <br><a href="http://www.miibeian.gov.cn/" target="_blank">蒙ICP备17004911号-1</a>
    		
    	</div>
      	<div class="footer-right">
          
            <a href="https://console.upyun.com/register/?invite=B1Tr4zsVf" target="_blank"> &nbsp; <img src="https://oss.xxwhite.com/static/upyun.png" width="100"></a>
          
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>      	
  </div>
</div></footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>


<script>loadScript("/assets/slider.818ebb.js")</script>

<script>
loadScript('https://www.googletagmanager.com/gtag/js?id=UA-113200574-1',function(){
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-113200574-1');
});
</script>



<script>
loadScript('https://hm.baidu.com/hm.js?893dcb25b87bcda2f682b3a6d5c537f7');
</script>



<script async>
loadScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js',function(){pangu.spacingPage();});
</script>

    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    
    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于本站</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">搞机</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">建站笔记</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">Unity</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">随便水水</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">测试</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">C#</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">涨姿势</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">软件</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">炎黄幼儿园</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">小工具</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">服务器</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">个人电脑</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">香橙派</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">dotnet</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="https://blog.xxwhite.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>叉叉白</a>
            </li>
          
            <li class="search-li">
              <a href="https://minemine.cc/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>大姐姐的博客Minemine</a>
            </li>
          
            <li class="search-li">
              <a href="http://socoolapk.top/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>酷安基佬</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.se7ensec.cn/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Se7en</a>
            </li>
          
            <li class="search-li">
              <a href="https://blog.isoyu.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>姬长信</a>
            </li>
          
            <li class="search-li">
              <a href="http://staunchkai.com/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>staunchkai</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.iszy.cc/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>随遇而安</a>
            </li>
          
            <li class="search-li">
              <a href="https://zsh2401.top/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>2401的晚秋咖啡</a>
            </li>
          
            <li class="search-li">
              <a href="https://liujunzhou.top/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Junzhou Liu</a>
            </li>
          
            <li class="search-li">
              <a href="https://yi-yun.github.io/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Yi-Yun</a>
            </li>
          
            <li class="search-li">
              <a href="https://www.lmcjl.com" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>LmCjl在线工具</a>
            </li>
          
        </ul>
  		
    	</section>
    
    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">叉叉白&lt;br&gt;&lt;br&gt;一个小白搞机的记事本</div>
  	  	
    	</section>
    
  </div>  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>